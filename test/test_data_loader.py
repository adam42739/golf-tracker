import golftrack
import pandas as pd
import numpy as np
from pandas.testing import assert_frame_equal


def test_TrackerData():
    data = golftrack.TrackerData(
        "test/test_data/courses.xlsx", "test/test_data/scorecards.xlsx"
    )

    expected_df = pd.DataFrame(
        {
            "Score": {
                ("CGC-W-05222025", 1): 8,
                ("CGC-W-05222025", 2): 6,
                ("CGC-W-05222025", 3): 7,
                ("CGC-W-05222025", 4): 6,
                ("CGC-W-05222025", 5): 8,
                ("CGC-W-05222025", 6): 5,
                ("CGC-W-05222025", 7): 6,
                ("CGC-W-05222025", 8): 7,
                ("CGC-W-05222025", 9): 8,
                ("CGC-W-05232025", 1): 8,
                ("CGC-W-05232025", 2): 7,
                ("CGC-W-05232025", 3): 5,
                ("CGC-W-05232025", 4): 8,
                ("CGC-W-05232025", 5): 7,
                ("CGC-W-05232025", 6): 10,
                ("CGC-W-05232025", 7): 4,
                ("CGC-W-05232025", 8): 7,
                ("CGC-W-05232025", 9): 9,
                ("CGC-W-05302025", 1): 5,
                ("CGC-W-05302025", 2): 7,
                ("CGC-W-05302025", 3): 6,
                ("CGC-W-05302025", 4): 7,
                ("CGC-W-05302025", 5): 9,
                ("CGC-W-05302025", 6): 10,
                ("CGC-W-05302025", 7): 6,
                ("CGC-W-05302025", 8): 8,
                ("CGC-W-05302025", 9): 7,
                ("CGC-W-05312025", 1): 6,
                ("CGC-W-05312025", 2): 7,
                ("CGC-W-05312025", 3): 4,
                ("CGC-W-05312025", 4): 9,
                ("CGC-W-05312025", 5): 5,
                ("CGC-W-05312025", 6): 6,
                ("CGC-W-05312025", 7): 6,
                ("CGC-W-05312025", 8): 6,
                ("CGC-W-05312025", 9): 9,
                ("CGC-W-06022025", 1): 9,
                ("CGC-W-06022025", 2): 7,
                ("CGC-W-06022025", 3): 4,
                ("CGC-W-06022025", 4): 8,
                ("CGC-W-06022025", 5): 6,
                ("CGC-W-06022025", 6): 7,
                ("CGC-W-06022025", 7): 4,
                ("CGC-W-06022025", 8): 7,
                ("CGC-W-06022025", 9): 8,
            },
            "Tee Fairway": {
                ("CGC-W-05222025", 1): np.nan,
                ("CGC-W-05222025", 2): np.nan,
                ("CGC-W-05222025", 3): np.nan,
                ("CGC-W-05222025", 4): np.nan,
                ("CGC-W-05222025", 5): np.nan,
                ("CGC-W-05222025", 6): np.nan,
                ("CGC-W-05222025", 7): np.nan,
                ("CGC-W-05222025", 8): np.nan,
                ("CGC-W-05222025", 9): np.nan,
                ("CGC-W-05232025", 1): np.nan,
                ("CGC-W-05232025", 2): np.nan,
                ("CGC-W-05232025", 3): np.nan,
                ("CGC-W-05232025", 4): np.nan,
                ("CGC-W-05232025", 5): np.nan,
                ("CGC-W-05232025", 6): np.nan,
                ("CGC-W-05232025", 7): np.nan,
                ("CGC-W-05232025", 8): np.nan,
                ("CGC-W-05232025", 9): np.nan,
                ("CGC-W-05302025", 1): np.nan,
                ("CGC-W-05302025", 2): np.nan,
                ("CGC-W-05302025", 3): np.nan,
                ("CGC-W-05302025", 4): np.nan,
                ("CGC-W-05302025", 5): np.nan,
                ("CGC-W-05302025", 6): np.nan,
                ("CGC-W-05302025", 7): np.nan,
                ("CGC-W-05302025", 8): np.nan,
                ("CGC-W-05302025", 9): np.nan,
                ("CGC-W-05312025", 1): np.nan,
                ("CGC-W-05312025", 2): np.nan,
                ("CGC-W-05312025", 3): np.nan,
                ("CGC-W-05312025", 4): np.nan,
                ("CGC-W-05312025", 5): np.nan,
                ("CGC-W-05312025", 6): np.nan,
                ("CGC-W-05312025", 7): np.nan,
                ("CGC-W-05312025", 8): np.nan,
                ("CGC-W-05312025", 9): np.nan,
                ("CGC-W-06022025", 1): 1.0,
                ("CGC-W-06022025", 2): 1.0,
                ("CGC-W-06022025", 3): 0.0,
                ("CGC-W-06022025", 4): 1.0,
                ("CGC-W-06022025", 5): 1.0,
                ("CGC-W-06022025", 6): 0.0,
                ("CGC-W-06022025", 7): 0.0,
                ("CGC-W-06022025", 8): 0.0,
                ("CGC-W-06022025", 9): 0.0,
            },
            "Fairway Hits": {
                ("CGC-W-05222025", 1): np.nan,
                ("CGC-W-05222025", 2): np.nan,
                ("CGC-W-05222025", 3): np.nan,
                ("CGC-W-05222025", 4): np.nan,
                ("CGC-W-05222025", 5): np.nan,
                ("CGC-W-05222025", 6): np.nan,
                ("CGC-W-05222025", 7): np.nan,
                ("CGC-W-05222025", 8): np.nan,
                ("CGC-W-05222025", 9): np.nan,
                ("CGC-W-05232025", 1): np.nan,
                ("CGC-W-05232025", 2): np.nan,
                ("CGC-W-05232025", 3): np.nan,
                ("CGC-W-05232025", 4): np.nan,
                ("CGC-W-05232025", 5): np.nan,
                ("CGC-W-05232025", 6): np.nan,
                ("CGC-W-05232025", 7): np.nan,
                ("CGC-W-05232025", 8): np.nan,
                ("CGC-W-05232025", 9): np.nan,
                ("CGC-W-05302025", 1): np.nan,
                ("CGC-W-05302025", 2): np.nan,
                ("CGC-W-05302025", 3): np.nan,
                ("CGC-W-05302025", 4): np.nan,
                ("CGC-W-05302025", 5): np.nan,
                ("CGC-W-05302025", 6): np.nan,
                ("CGC-W-05302025", 7): np.nan,
                ("CGC-W-05302025", 8): np.nan,
                ("CGC-W-05302025", 9): np.nan,
                ("CGC-W-05312025", 1): np.nan,
                ("CGC-W-05312025", 2): np.nan,
                ("CGC-W-05312025", 3): np.nan,
                ("CGC-W-05312025", 4): np.nan,
                ("CGC-W-05312025", 5): np.nan,
                ("CGC-W-05312025", 6): np.nan,
                ("CGC-W-05312025", 7): np.nan,
                ("CGC-W-05312025", 8): np.nan,
                ("CGC-W-05312025", 9): np.nan,
                ("CGC-W-06022025", 1): 0.0,
                ("CGC-W-06022025", 2): 0.0,
                ("CGC-W-06022025", 3): 0.0,
                ("CGC-W-06022025", 4): 0.0,
                ("CGC-W-06022025", 5): 1.0,
                ("CGC-W-06022025", 6): 1.0,
                ("CGC-W-06022025", 7): 0.0,
                ("CGC-W-06022025", 8): 1.0,
                ("CGC-W-06022025", 9): 2.0,
            },
            "Chips": {
                ("CGC-W-05222025", 1): np.nan,
                ("CGC-W-05222025", 2): np.nan,
                ("CGC-W-05222025", 3): np.nan,
                ("CGC-W-05222025", 4): np.nan,
                ("CGC-W-05222025", 5): np.nan,
                ("CGC-W-05222025", 6): np.nan,
                ("CGC-W-05222025", 7): np.nan,
                ("CGC-W-05222025", 8): np.nan,
                ("CGC-W-05222025", 9): np.nan,
                ("CGC-W-05232025", 1): np.nan,
                ("CGC-W-05232025", 2): np.nan,
                ("CGC-W-05232025", 3): np.nan,
                ("CGC-W-05232025", 4): np.nan,
                ("CGC-W-05232025", 5): np.nan,
                ("CGC-W-05232025", 6): np.nan,
                ("CGC-W-05232025", 7): np.nan,
                ("CGC-W-05232025", 8): np.nan,
                ("CGC-W-05232025", 9): np.nan,
                ("CGC-W-05302025", 1): np.nan,
                ("CGC-W-05302025", 2): np.nan,
                ("CGC-W-05302025", 3): np.nan,
                ("CGC-W-05302025", 4): np.nan,
                ("CGC-W-05302025", 5): np.nan,
                ("CGC-W-05302025", 6): np.nan,
                ("CGC-W-05302025", 7): np.nan,
                ("CGC-W-05302025", 8): np.nan,
                ("CGC-W-05302025", 9): np.nan,
                ("CGC-W-05312025", 1): np.nan,
                ("CGC-W-05312025", 2): np.nan,
                ("CGC-W-05312025", 3): np.nan,
                ("CGC-W-05312025", 4): np.nan,
                ("CGC-W-05312025", 5): np.nan,
                ("CGC-W-05312025", 6): np.nan,
                ("CGC-W-05312025", 7): np.nan,
                ("CGC-W-05312025", 8): np.nan,
                ("CGC-W-05312025", 9): np.nan,
                ("CGC-W-06022025", 1): 1.0,
                ("CGC-W-06022025", 2): 0.0,
                ("CGC-W-06022025", 3): 1.0,
                ("CGC-W-06022025", 4): 4.0,
                ("CGC-W-06022025", 5): 2.0,
                ("CGC-W-06022025", 6): 1.0,
                ("CGC-W-06022025", 7): 1.0,
                ("CGC-W-06022025", 8): 1.0,
                ("CGC-W-06022025", 9): 2.0,
            },
            "Putts": {
                ("CGC-W-05222025", 1): np.nan,
                ("CGC-W-05222025", 2): np.nan,
                ("CGC-W-05222025", 3): np.nan,
                ("CGC-W-05222025", 4): np.nan,
                ("CGC-W-05222025", 5): np.nan,
                ("CGC-W-05222025", 6): np.nan,
                ("CGC-W-05222025", 7): np.nan,
                ("CGC-W-05222025", 8): np.nan,
                ("CGC-W-05222025", 9): np.nan,
                ("CGC-W-05232025", 1): 2.0,
                ("CGC-W-05232025", 2): 2.0,
                ("CGC-W-05232025", 3): 2.0,
                ("CGC-W-05232025", 4): 2.0,
                ("CGC-W-05232025", 5): 3.0,
                ("CGC-W-05232025", 6): 4.0,
                ("CGC-W-05232025", 7): 2.0,
                ("CGC-W-05232025", 8): 3.0,
                ("CGC-W-05232025", 9): 2.0,
                ("CGC-W-05302025", 1): 1.0,
                ("CGC-W-05302025", 2): 3.0,
                ("CGC-W-05302025", 3): 3.0,
                ("CGC-W-05302025", 4): 3.0,
                ("CGC-W-05302025", 5): 3.0,
                ("CGC-W-05302025", 6): 2.0,
                ("CGC-W-05302025", 7): 1.0,
                ("CGC-W-05302025", 8): 2.0,
                ("CGC-W-05302025", 9): 2.0,
                ("CGC-W-05312025", 1): 3.0,
                ("CGC-W-05312025", 2): 3.0,
                ("CGC-W-05312025", 3): 2.0,
                ("CGC-W-05312025", 4): 2.0,
                ("CGC-W-05312025", 5): 2.0,
                ("CGC-W-05312025", 6): 2.0,
                ("CGC-W-05312025", 7): 3.0,
                ("CGC-W-05312025", 8): 3.0,
                ("CGC-W-05312025", 9): 2.0,
                ("CGC-W-06022025", 1): 2.0,
                ("CGC-W-06022025", 2): 2.0,
                ("CGC-W-06022025", 3): 2.0,
                ("CGC-W-06022025", 4): 2.0,
                ("CGC-W-06022025", 5): 2.0,
                ("CGC-W-06022025", 6): 2.0,
                ("CGC-W-06022025", 7): 2.0,
                ("CGC-W-06022025", 8): 2.0,
                ("CGC-W-06022025", 9): 2.0,
            },
            "Course Code": {
                ("CGC-W-05222025", 1): "CGC-W",
                ("CGC-W-05222025", 2): "CGC-W",
                ("CGC-W-05222025", 3): "CGC-W",
                ("CGC-W-05222025", 4): "CGC-W",
                ("CGC-W-05222025", 5): "CGC-W",
                ("CGC-W-05222025", 6): "CGC-W",
                ("CGC-W-05222025", 7): "CGC-W",
                ("CGC-W-05222025", 8): "CGC-W",
                ("CGC-W-05222025", 9): "CGC-W",
                ("CGC-W-05232025", 1): "CGC-W",
                ("CGC-W-05232025", 2): "CGC-W",
                ("CGC-W-05232025", 3): "CGC-W",
                ("CGC-W-05232025", 4): "CGC-W",
                ("CGC-W-05232025", 5): "CGC-W",
                ("CGC-W-05232025", 6): "CGC-W",
                ("CGC-W-05232025", 7): "CGC-W",
                ("CGC-W-05232025", 8): "CGC-W",
                ("CGC-W-05232025", 9): "CGC-W",
                ("CGC-W-05302025", 1): "CGC-W",
                ("CGC-W-05302025", 2): "CGC-W",
                ("CGC-W-05302025", 3): "CGC-W",
                ("CGC-W-05302025", 4): "CGC-W",
                ("CGC-W-05302025", 5): "CGC-W",
                ("CGC-W-05302025", 6): "CGC-W",
                ("CGC-W-05302025", 7): "CGC-W",
                ("CGC-W-05302025", 8): "CGC-W",
                ("CGC-W-05302025", 9): "CGC-W",
                ("CGC-W-05312025", 1): "CGC-W",
                ("CGC-W-05312025", 2): "CGC-W",
                ("CGC-W-05312025", 3): "CGC-W",
                ("CGC-W-05312025", 4): "CGC-W",
                ("CGC-W-05312025", 5): "CGC-W",
                ("CGC-W-05312025", 6): "CGC-W",
                ("CGC-W-05312025", 7): "CGC-W",
                ("CGC-W-05312025", 8): "CGC-W",
                ("CGC-W-05312025", 9): "CGC-W",
                ("CGC-W-06022025", 1): "CGC-W",
                ("CGC-W-06022025", 2): "CGC-W",
                ("CGC-W-06022025", 3): "CGC-W",
                ("CGC-W-06022025", 4): "CGC-W",
                ("CGC-W-06022025", 5): "CGC-W",
                ("CGC-W-06022025", 6): "CGC-W",
                ("CGC-W-06022025", 7): "CGC-W",
                ("CGC-W-06022025", 8): "CGC-W",
                ("CGC-W-06022025", 9): "CGC-W",
            },
            "Yardage": {
                ("CGC-W-05222025", 1): 256,
                ("CGC-W-05222025", 2): 393,
                ("CGC-W-05222025", 3): 170,
                ("CGC-W-05222025", 4): 272,
                ("CGC-W-05222025", 5): 333,
                ("CGC-W-05222025", 6): 439,
                ("CGC-W-05222025", 7): 165,
                ("CGC-W-05222025", 8): 343,
                ("CGC-W-05222025", 9): 451,
                ("CGC-W-05232025", 1): 256,
                ("CGC-W-05232025", 2): 393,
                ("CGC-W-05232025", 3): 170,
                ("CGC-W-05232025", 4): 272,
                ("CGC-W-05232025", 5): 333,
                ("CGC-W-05232025", 6): 439,
                ("CGC-W-05232025", 7): 165,
                ("CGC-W-05232025", 8): 343,
                ("CGC-W-05232025", 9): 451,
                ("CGC-W-05302025", 1): 256,
                ("CGC-W-05302025", 2): 393,
                ("CGC-W-05302025", 3): 170,
                ("CGC-W-05302025", 4): 272,
                ("CGC-W-05302025", 5): 333,
                ("CGC-W-05302025", 6): 439,
                ("CGC-W-05302025", 7): 165,
                ("CGC-W-05302025", 8): 343,
                ("CGC-W-05302025", 9): 451,
                ("CGC-W-05312025", 1): 256,
                ("CGC-W-05312025", 2): 393,
                ("CGC-W-05312025", 3): 170,
                ("CGC-W-05312025", 4): 272,
                ("CGC-W-05312025", 5): 333,
                ("CGC-W-05312025", 6): 439,
                ("CGC-W-05312025", 7): 165,
                ("CGC-W-05312025", 8): 343,
                ("CGC-W-05312025", 9): 451,
                ("CGC-W-06022025", 1): 256,
                ("CGC-W-06022025", 2): 393,
                ("CGC-W-06022025", 3): 170,
                ("CGC-W-06022025", 4): 272,
                ("CGC-W-06022025", 5): 333,
                ("CGC-W-06022025", 6): 439,
                ("CGC-W-06022025", 7): 165,
                ("CGC-W-06022025", 8): 343,
                ("CGC-W-06022025", 9): 451,
            },
            "Par": {
                ("CGC-W-05222025", 1): 4,
                ("CGC-W-05222025", 2): 4,
                ("CGC-W-05222025", 3): 3,
                ("CGC-W-05222025", 4): 4,
                ("CGC-W-05222025", 5): 4,
                ("CGC-W-05222025", 6): 5,
                ("CGC-W-05222025", 7): 3,
                ("CGC-W-05222025", 8): 4,
                ("CGC-W-05222025", 9): 5,
                ("CGC-W-05232025", 1): 4,
                ("CGC-W-05232025", 2): 4,
                ("CGC-W-05232025", 3): 3,
                ("CGC-W-05232025", 4): 4,
                ("CGC-W-05232025", 5): 4,
                ("CGC-W-05232025", 6): 5,
                ("CGC-W-05232025", 7): 3,
                ("CGC-W-05232025", 8): 4,
                ("CGC-W-05232025", 9): 5,
                ("CGC-W-05302025", 1): 4,
                ("CGC-W-05302025", 2): 4,
                ("CGC-W-05302025", 3): 3,
                ("CGC-W-05302025", 4): 4,
                ("CGC-W-05302025", 5): 4,
                ("CGC-W-05302025", 6): 5,
                ("CGC-W-05302025", 7): 3,
                ("CGC-W-05302025", 8): 4,
                ("CGC-W-05302025", 9): 5,
                ("CGC-W-05312025", 1): 4,
                ("CGC-W-05312025", 2): 4,
                ("CGC-W-05312025", 3): 3,
                ("CGC-W-05312025", 4): 4,
                ("CGC-W-05312025", 5): 4,
                ("CGC-W-05312025", 6): 5,
                ("CGC-W-05312025", 7): 3,
                ("CGC-W-05312025", 8): 4,
                ("CGC-W-05312025", 9): 5,
                ("CGC-W-06022025", 1): 4,
                ("CGC-W-06022025", 2): 4,
                ("CGC-W-06022025", 3): 3,
                ("CGC-W-06022025", 4): 4,
                ("CGC-W-06022025", 5): 4,
                ("CGC-W-06022025", 6): 5,
                ("CGC-W-06022025", 7): 3,
                ("CGC-W-06022025", 8): 4,
                ("CGC-W-06022025", 9): 5,
            },
            "Handicap": {
                ("CGC-W-05222025", 1): 9,
                ("CGC-W-05222025", 2): 2,
                ("CGC-W-05222025", 3): 8,
                ("CGC-W-05222025", 4): 3,
                ("CGC-W-05222025", 5): 1,
                ("CGC-W-05222025", 6): 7,
                ("CGC-W-05222025", 7): 4,
                ("CGC-W-05222025", 8): 5,
                ("CGC-W-05222025", 9): 6,
                ("CGC-W-05232025", 1): 9,
                ("CGC-W-05232025", 2): 2,
                ("CGC-W-05232025", 3): 8,
                ("CGC-W-05232025", 4): 3,
                ("CGC-W-05232025", 5): 1,
                ("CGC-W-05232025", 6): 7,
                ("CGC-W-05232025", 7): 4,
                ("CGC-W-05232025", 8): 5,
                ("CGC-W-05232025", 9): 6,
                ("CGC-W-05302025", 1): 9,
                ("CGC-W-05302025", 2): 2,
                ("CGC-W-05302025", 3): 8,
                ("CGC-W-05302025", 4): 3,
                ("CGC-W-05302025", 5): 1,
                ("CGC-W-05302025", 6): 7,
                ("CGC-W-05302025", 7): 4,
                ("CGC-W-05302025", 8): 5,
                ("CGC-W-05302025", 9): 6,
                ("CGC-W-05312025", 1): 9,
                ("CGC-W-05312025", 2): 2,
                ("CGC-W-05312025", 3): 8,
                ("CGC-W-05312025", 4): 3,
                ("CGC-W-05312025", 5): 1,
                ("CGC-W-05312025", 6): 7,
                ("CGC-W-05312025", 7): 4,
                ("CGC-W-05312025", 8): 5,
                ("CGC-W-05312025", 9): 6,
                ("CGC-W-06022025", 1): 9,
                ("CGC-W-06022025", 2): 2,
                ("CGC-W-06022025", 3): 8,
                ("CGC-W-06022025", 4): 3,
                ("CGC-W-06022025", 5): 1,
                ("CGC-W-06022025", 6): 7,
                ("CGC-W-06022025", 7): 4,
                ("CGC-W-06022025", 8): 5,
                ("CGC-W-06022025", 9): 6,
            },
        }
    )
    expected_df.index.names = ["Round Code", "Hole"]

    assert_frame_equal(data.get(), expected_df)
